/*!
 * History API JavaScript Library v4.1.0
 *
 * Support: IE6+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 2014-03-24 13:14
 */
(function(e){var i=!0,j=null,p=!1;function K(){}function h(a,b,c){if(a!=j&&""!==a&&!b)var b=h(),c=b.e,f=b.h,a=""+a,a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?f+a:a:f+"//"+b.g+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b.f+a:c.replace(/[^\/]+$/g,"")+a);else if(a=b?a:d.href,!q||c)a=a.replace(/^[^#]*/,"")||"#",a=d.protocol.replace(/:.*$|$/,":")+"//"+d.host+k.basepath+a.replace(RegExp("^#[/]?(?:"+k.type+")?"),"");P.href=a;var a=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(P.href),b=
a[2]+(a[3]?":"+a[3]:""),c=a[4]||"/",f=a[5]||"",e="#"===a[6]?"":a[6]||"",m=c+f+e,v=c.replace(RegExp("^"+k.basepath,"i"),k.type)+f;return{a:a[1]+"//"+b+m,h:a[1],g:b,i:a[2],k:a[3]||"",e:c,f:f,b:e,c:m,j:v,d:v+e}}function $(){var a;try{a=e.sessionStorage,a.setItem(F+"t","1"),a.removeItem(F+"t")}catch(b){a={getItem:function(a){a=g.cookie.split(a+"=");return 1<a.length&&a.pop().split(";").shift()||"null"},setItem:function(a){var b={};if(b[d.href]=l.state)g.cookie=a+"="+r.stringify(b)}}}try{s=r.parse(a.getItem(F))||
{}}catch(c){s={}}w(x+"unload",function(){a.setItem(F,r.stringify(s))},p)}function y(a,b,c,f){var c=c||{set:K},d=!c.set,m=!c.get,v={configurable:i,set:function(){d=1},get:function(){m=1}};try{D(a,b,v),a[b]=a[b],D(a,b,c)}catch(ja){}if(!d||!m)if(a.__defineGetter__&&(a.__defineGetter__(b,v.get),a.__defineSetter__(b,v.set),a[b]=a[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)),(!d||!m)&&a===e){try{var aa=a[b];a[b]=j}catch(n){}if("execScript"in e)e.execScript("Public "+b,"VBScript");
else try{D(a,b,{value:K})}catch(g){}a[b]=aa}else if(!d||!m)try{try{var z=G.create(a);D(G.getPrototypeOf(z)===a?z:a,b,c);for(var h in a)"function"===typeof a[h]&&(z[h]=a[h].bind(a));try{f.call(z,z,a)}catch(l){}a=z}catch(k){D(a.constructor.prototype,b,c)}}catch(o){return p}return a}function ba(a,b,c){c=c||{};a=a===L?d:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function ca(a,b,c){a in A?A[a].push(b):3<arguments.length?w(a,b,c,arguments[3]):w(a,b,c)}function da(a,
b,c){var e=A[a];if(e)for(a=e.length;--a;){if(e[a]===b){e.splice(a,1);break}}else Q(a,b,c)}function H(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),f=A[c];if(f){b="string"===typeof a?b:a;if(b.target==j)for(var d=["target","currentTarget","srcElement","type"];a=d.pop();)b=y(b,a,{get:"type"===a?function(){return c}:function(){return e}});(("popstate"===c?e.onpopstate:e.onhashchange)||K).call(e,b);for(var d=0,g=f.length;d<g;d++)f[d].call(e,b);return i}return ea(a,b)}function R(){var a=
g.createEvent?g.createEvent("Event"):g.createEventObject();a.initEvent?a.initEvent("popstate",p,p):a.type="popstate";a.state=l.state;H(a)}function t(a,b,c,e){q||(b=h(b),b.c!==h().c&&(B=e,c?d.replace("#"+b.d):d.hash=b.d));!I&&a&&(s[d.href]=a);E=p}function M(a){var b=B;B=d.href;if(b){S!==d.href&&R();var a=a||e.event,b=h(B,i),c=h();a.oldURL||(a.oldURL=b.a,a.newURL=c.a);b.b!==c.b&&H(a)}}function T(a){setTimeout(function(){w("popstate",function(a){S=d.href;I||(a=y(a,"state",{get:function(){return l.state}}));
H(a)},p)},0);!q&&(a!==i&&l.location)&&(U(l.location.hash),E&&(E=p,R()))}function fa(a){var a=a||e.event,b;a:{for(b=a.target||a.srcElement;b;){if("A"===b.nodeName)break a;b=b.parentNode}b=void 0}var c="defaultPrevented"in a?a.defaultPrevented:a.returnValue===p;b&&("A"===b.nodeName&&!c)&&(c=h(),b=h(b.getAttribute("href",2)),c.a.split("#").shift()===b.a.split("#").shift()&&b.b&&(c.b!==b.b&&(l.location.hash=b.b),U(b.b),a.preventDefault?a.preventDefault():a.returnValue=p))}function U(a){var b=g.getElementById(a=
(a||"").replace(/^#/,""));b&&(b.id===a&&"A"===b.nodeName)&&(a=b.getBoundingClientRect(),e.scrollTo(J.scrollLeft||0,a.top+(J.scrollTop||0)-(J.clientTop||0)))}function ga(){var a=g.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){k[b]=(c||("basepath"===b?"/":"")).replace(/^(0|false)$/,"")});ha();w(x+"hashchange",M,p);var b=[L,u,ia,e,V,l];I&&delete V.state;for(var c=0;c<b.length;c+=2)for(var d in b[c])if(b[c].hasOwnProperty(d))if("function"===
typeof b[c][d])b[c+1][d]=b[c][d];else{a=ba(b[c],d,b[c][d]);if(!y(b[c+1],d,a,function(a,d){if(d===l)e.history=l=b[c+1]=a}))return Q(x+"hashchange",M,p),p;b[c+1]===e&&(A[d]=A[d.substr(2)]=[])}k.redirect&&l.redirect();!I&&r&&$();if(!q)g[N](x+"click",fa,p);"complete"===g.readyState?T(i):(!q&&h().c!==k.basepath&&(E=i),w(x+"load",T,p));return i}function ha(){function a(a){var b=[],d="VBHistoryClass"+(new Date).getTime()+c++,n=["Class "+d],f;for(f in a)if(a.hasOwnProperty(f)){var g=a[f];g&&(g.get||g.set)?
(g.get&&n.push("Public "+("_"===f?"Default ":"")+"Property Get ["+f+"]","Call VBCVal([(accessors)].["+f+"].get.call(me),["+f+"])","End Property"),g.set&&n.push("Public Property Let ["+f+"](val)",g="Call [(accessors)].["+f+"].set.call(me,val)\nEnd Property","Public Property Set ["+f+"](val)",g)):(b.push(f),n.push("Public ["+f+"]"))}n.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+
d,"End Function");e.execScript(n.join("\n"),"VBScript");e[d+"FactoryJS"]=function(){return a};d=e[d+"Factory"]();for(n=0;n<b.length;n++)d[b[n]]=a[b[n]];return d}function b(a){var b=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.test(a)?'"'+a.replace(b,function(a){return a in c?c[a]:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+
'"':'"'+a+'"'}var c=e.eval&&eval("/*@cc_on 1;@*/");if(c&&!(7<+(/msie (\d+)/i.exec(navigator.userAgent)||[,8])[1])){var f=y,k=h().a,m=g.createElement("iframe");m.src="javascript:true;";m=J.firstChild.appendChild(m).contentWindow;e.execScript("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");u={_:{get:L.toString}};l={back:o.back,forward:o.forward,go:o.go,emulate:j,_:{get:function(){return"[object History]"}}};r={parse:function(a){try{return(new Function("",
"return "+a))()}catch(b){return j}},stringify:function(a){var c=(typeof a).charCodeAt(2);if(114===c)a=b(a);else if(109===c)a=isFinite(a)?""+a:"null";else if(111===c||108===c)a=""+a;else if(106===c)if(a){var d=(c="[object Array]"===G.prototype.toString.call(a))?"[":"{";if(c)for(var e=0;e<a.length;e++)d+=(0==e?"":",")+r.stringify(a[e]);else for(e in a)a.hasOwnProperty(e)&&(d+=(1==d.length?"":",")+b(e)+":"+r.stringify(a[e]));a=d+(c?"]":"}")}else a="null";else a="void 0";return a}};t=function(a,b,c,e,
f){var g=m.document,b=h(b);E=p;if(b.c===h().c&&!f)a&&(s[d.href]=a);else{B=e;if(c)m.lfirst?(history.back(),t(a,b.a,0,e,1)):d.replace("#"+b.d);else if(b.a!=k||f)m.lfirst||(m.lfirst=1,t(a,k,0,e,1)),g.open(),g.write('<script>lfirst=1;parent.location.hash="'+b.d.replace(/"/g,'\\"')+'";<\/script>'),g.close();!f&&a&&(s[d.href]=a)}};y=function(b,c,d,g){f.apply(this,arguments)||(b===u?u[c]=d:b===l?(l[c]=d,"state"===c&&(u=a(u),e.history=l=a(l))):b[c]=d.get&&d.get());return b};setInterval(function(){var a=h().a;
if(a!=k){var b=g.createEventObject();b.oldURL=k;b.newURL=k=a;b.type="hashchange";M(b)}},100);e.JSON=r}}if(e.history){var g=e.document,J=g.documentElement,G=e.Object,r=e.JSON,d=e.location,o=e.history,l=o,O=o.pushState,W=o.replaceState,q=!!O,I="state"in o,D=G.defineProperty,u=y({},"t")?{}:g.createElement("a"),x="",N=e.addEventListener?"addEventListener":(x="on")&&"attachEvent",X=e.removeEventListener?"removeEventListener":"detachEvent",Y=e.dispatchEvent?"dispatchEvent":"fireEvent",w=e[N],Q=e[X],ea=
e[Y],k={basepath:"/",redirect:0,type:"/"},F="__historyAPI__",P=g.createElement("a"),B=d.href,S="",E=p,s={},A={},C=g.title,ia={onhashchange:j,onpopstate:j},Z=function(a,b){var c=e.history!==o;c&&(e.history=o);a.apply(o,b);c&&(e.history=l)},V={redirect:function(a,b){k.basepath=b=b==j?k.basepath:b;k.type=a=a==j?k.type:a;if(e.top==e.self){var c=h(j,p,i).c,f=d.pathname+d.search;q?(f=f.replace(/([^\/])$/,"$1/"),c!=b&&RegExp("^"+b+"$","i").test(f)&&d.replace(c)):f!=b&&(f=f.replace(/([^\/])\?/,"$1/?"),RegExp("^"+
b,"i").test(f)&&d.replace(b+"#"+f.replace(RegExp("^"+b,"i"),a)+d.hash))}},pushState:function(a,b,c){var d=g.title;C!=j&&(g.title=C);O&&Z(O,arguments);t(a,c);g.title=d;C=b},replaceState:function(a,b,c){var e=g.title;C!=j&&(g.title=C);delete s[d.href];W&&Z(W,arguments);t(a,c,i);g.title=e;C=b},location:{set:function(a){e.location=a},get:function(){return q?d:u}},state:{get:function(){return s[d.href]||j}}},L={assign:function(a){0===(""+a).indexOf("#")?t(j,a):d.assign(a)},reload:function(){d.reload()},
replace:function(a){0===(""+a).indexOf("#")?t(j,a,i):d.replace(a)},toString:function(){return this.href},href:{get:function(){return h().a}},protocol:j,host:j,hostname:j,port:j,pathname:{get:function(){return h().e}},search:{get:function(){return h().f}},hash:{set:function(a){t(j,(""+a).replace(/^(#|)/,"#"),p,B)},get:function(){return h().b}}};ga()&&(l.emulate=!q,e[N]=ca,e[X]=da,e[Y]=H)}})(window);
